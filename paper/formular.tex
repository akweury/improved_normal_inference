RGB image will be stored as gray value Scene using following equation:
\[ gray: \frac{r+2g+b}{4}  \]


\subsection{Normal from k neighbors}

Given a point $ p $ locating on plane $ \Pi $, calculate the normal $ n $ of plane $ \Pi $. 

First, find the nearest $ k $ neighbors $ p_1,p_2,...,p_k $ of point $ p $ using KNN-algorithms. 
The plane $ \Pi $ containing point $ p $ can be fitted using the neighbors of point $ p $. 
Then the normal is available immediately.

Assume all the neighbors of point $ p $ are in plane $ \Pi = ax+by+cz+d=0 $. Since we only need calculate the normal, thus with out loss of generation, we can set displacement $ d = 0 $. Then the normal $  \bn = (a,b,c)^T  $.

Since all the neighbors of point $ p $ are located on plane $ \Pi $, thus we have 
\[ 
P_{k \times 3} \cdot  \bn_{3 \times 1} = \left(
\begin{matrix}
0 \\
0\\
0
\end{matrix}  \right) \]
In order to avoid trivial solution, one more constraint should be added
\[ \|  \bn_{3 \times 1} \|_2^2 = 1  \], which also let the normal to be a unit vector.
In order to calculate a valid normal, 3 points are required at least. For the sake of robust, more points can be used to reduce the measuring error. In this case, the equation system is over-determined, which can be modeled as following optimization problem
\begin{equation}
	\begin{array}{rrclcl}
		\displaystyle \min & \multicolumn{3}{l}{\| P  \bn \|^2} \\
		\\
		\textrm{s.t.} & \| \bn \|^2 & = & 1 
	\end{array}
\end{equation}
Let the decomposition of $ P=U\Sigma V^T $, The solution i.e. normal is the last column of $ V $.


\subsection{Normalized Convolution}




